generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model BinanceCurrency {
  id                 Int      @default(autoincrement()) @id
  symbol             String   @unique
  lastPrice          String?
  openPrice          String?
  highPrice          String?
  lowPrice           String?
  priceChange        String?
  priceChangePercent String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @default(now())
}

model BitmexCurrency {
  id               Int      @default(autoincrement()) @id
  symbol           String   @unique
  underlying       String   @unique
  active           Boolean? @default(false)
  fractionalDigits Int?
  lastPrice        Float?
  markPrice        Float?
  tickSize         Float?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @default(now())
}

model Order {
  id            Int        @default(autoincrement()) @id
  orderSetId    Int
  membershipId  Int
  symbol        String
  side          OrderSide
  lastTimestamp DateTime?
  orderType     OrderType?
  price         Float?
  stopPrice     Float?
  quantity      Float?
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @default(now())
  orderSet      OrderSet   @relation(fields: [orderSetId], references: [id])
}

model OrderSet {
  id          Int       @default(autoincrement()) @id
  description String?
  groupId     Int
  orderType   OrderType
  price       Float?
  stopPrice   Float?
  percent     Float
  side        OrderSide
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @default(now())
  exchange    Exchange
  symbol      String
  orders      Order[]
}

model ExchangeAccount {
  id           Int      @default(autoincrement()) @id
  active       Boolean  @default(false)
  exchange     Exchange
  membershipId Int
  apiKey       String
  apiSecret    String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now())

  @@unique([exchange, membershipId], name: "ExchangeAccount_exchange_membershipId_key")
}

enum Exchange {
  BINANCE
  BITMEX
}

enum OrderSide {
  BUY
  SELL
}

enum OrderType {
  LIMIT
  MARKET
}
